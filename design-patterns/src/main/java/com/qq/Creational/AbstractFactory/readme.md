# 抽象工厂模式

## 业务

业务初期，数据都存储在 MySQL 中，但随着业务发展，需要将数据存储到 Redis 等其他数据库。不同数据库的增删改查 api 不同。

## demo1

`DataController` 根据需要操作数据库的类型，通过 `ifelse` 来调用不同的数据库及对应操作，实现简单，但后期维护和拓展成本高。

## demo2

使用**抽象工厂模式**。

将数据库的相关对象封装为一个个接口 `IConnection`、`IStatement`，实现类为不同数据库的具体对象，内部维护了对相应数据库的操作。

定义了一个抽象工厂 `IDBFactory`，内部提供了获取数据库相关对象，具体的实现工厂分别对应不同的数据库类型，一个数据库工厂能够创建的所有数据库相关对象都是统一的。

一次数据库操作，相关的数据库对象类型应该都属于同一个数据库，因此一次业务在 `DataController` 中只需要创建对应的数据库工厂，之后创建的所有数据库对象都是属于一样的数据库，不必使用别的数据库工厂。

